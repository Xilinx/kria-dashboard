name: PR License Check

on:
  pull_request:
    branches:
      - '**'

jobs:
  run-license-check:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.9.12'
    
    - name: Echo Python version
      run: python3 --version    

    - name: Install dependencies
      run: python3 -m pip install requests

    - name: Debug PR Number
      run: echo "PR_NUMBER=${{ github.event.pull_request.number }}"

    - name: Debug PAT
      run: echo "PAT_TOKEN=${{ secrets.GH_PAT }}"

    - name: Run license.py
      id: license_check
      run: |
        PR_NUMBER=${{ github.event.pull_request.number }}
        PAT_TOKEN=${{ secrets.GH_PAT }}
        python3 license.py $PR_NUMBER $PAT_TOKEN

